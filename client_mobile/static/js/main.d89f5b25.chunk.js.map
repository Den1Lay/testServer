{"version":3,"sources":["constants/ActionTypes.js","store/reducers/cart.js","store/reducers/products.js","store/reducers/dialogs.js","store/reducers/index.js","utils/notification.js","utils/upFirstSimbol.js","core/axios.js","core/api/auth.js","actions/network.js","actions/index.js","store/index.js","view/components/Bread/index.js","view/components/Search/index.js","view/components/Target/index.js","view/components/CheckTags/index.js","view/components/Message/index.js","view/components/DateElement/index.js","view/components/MenuButton/index.js","view/pages/ChoosePage/layout/Header/index.js","view/containers/ChooseBoard/index.js","view/containers/Login/index.js","view/containers/Dialog/view.js","view/containers/Dialog/wrappers/base.js","view/containers/Dialog/wrappers/searchPeople.js","view/containers/TextReducer/index.js","view/pages/ChoosePage/layout/Main/index.js","view/containers/Navigation/index.js","view/pages/ChoosePage/index.js","view/pages/PreviewPage/index.js","view/pages/ResultPage/index.js","view/pages/TestPage/index.js","view/pages/LoginPage/index.js","view/pages/MessengerPage/layout/DialogsTab/index.js","view/pages/MessengerPage/layout/DialogsSearch/index.js","view/pages/MessengerPage/index.js","view/pages/MePage/layout/Editor/index.js","view/pages/MePage/layout/MeHeader/index.js","view/pages/MePage/index.js","view/pages/ChatPage/layout/ChatHeader/index.js","view/pages/ChatPage/layout/Chat/index.js","view/pages/ChatPage/layout/ChatInput/index.js","view/pages/ChatPage/index.js","view/App.js","index.js"],"names":["ADD_TO_CART","CHECKOUT_REQUEST","CHECKOUT_SUCCESS","CHECKOUT_FAILURE","MICRO_EVENT","ADD_ELEMENT","PRIVATE_MSG","JOIN_TO_ROOM","GET_MSGS","INIT","PICK_DIALOG","SET_DIALOG_TAB_MOD","SET_SEARCH_PEOPLE","CREATE_NEW_DIALOG","CREATE_MESSAGE","SET_MESSAGE","SET_DIALOG","READ_MESSAGES","SET_READ_MESSAGES","GET_POLL_MESSAGES","SET_V","SET_POLL_MESSAGES","EDIT_PROFILE","SET_PROFILE","SET_MY_PROFILE","SET_ONLINE","LOGOUT","ADD_QUERY","UNSET_DIALOG_ID","initialState","addedIds","quantityById","state","action","type","indexOf","productId","cart","console","log","defState","products","window","localStorage","testData","JSON","parse","reg","RegExp","data","replace","split","res","recurs","pass","path","name","splice","Math","random","length","count","floor","min","elems","push","payload","forEach","A","B","C","passData","stringify","prepareTestData","microElsDefState","elements","combineReducers","productsEvents","microEls","hasOwnProperty","defaultStatus","room","lastMessage","addres","message","v","dialogs","user","isAuth","choosenDialogId","readyMessengesData","dialogTabMod","searchPeople","newDialogTargetId","messageData","isLiveUnreaded","readMessagesPass","newProfileData","logOutId","showSearchPeople","getV","str","testFormatMessages","messages","sort","aCT","createdAt","bCT","Date","lastDate","mounth","day","i","workDate","newLastDate","getMonth","getDate","date","getStringDate","getEndpointMessage","text","author","readed","prevPoll","time","getHours","getMinutes","isMe","findThatDialog","id","resInd","dialog","msg","userId","dialogInd","poll","dialogId","targetUserId","partner","mod","filter","target","nickName","toLowerCase","searchText","_id","messagesId","isPartnerMessages","mi","loginName","password","status","online","savedId","openNotification","title","description","notification","upFirstSimbol","string","charAt","toUpperCase","substring","axios","defaults","baseURL","location","origin","headers","common","token","post","dataInit","types","effecter","isTokenLogin","dispatch","pickDialog","readMessages","middleware","thunk","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","reducer","applyMiddleware","socket","io","transports","on","ev","emit","setSearchPeople","setDialog","setMessage","setReadMessages","setPollMessages","setProfile","setOnline","reason","subscribe","getState","checkSimbol","lastRooms","rooms","partnerUnreadedMessagesIds","map","Bread","props","paths","useLocation","pathname","readyPaths","arr","sumPath","pathDls","preparePaths","className","to","Search","Target","onClick","src","history","useHistory","classNames","CheckableTag","Tag","CheckTags","fValue","sValue","fHandl","sHandl","checkParam","checked","Message","styleEffect","DateElement","MenuButton","MenuOutlined","CPHeader","connect","link","addElement","obj","ChooseBoard","rightPass","useState","routes","setRoutes","ar","getLastElem","mapDispatchToProps","createUser","auth","then","catch","er","loginUser","checkAuth","workPlace","setWorkPlace","passwordConfirm","setData","useEffect","from","chechProps","onSubmit","preventDefault","errors","error","placeholder","onChange","value","Password","htmlType","DialogView","imgPlug","messange","infoCount","messageDls","authorIsYou","isSearchPeopleMod","isChoosen","clickHandler","showData","me","choosenId","showTarget","revMessages","reverse","resCount","deathFlag","getUnreadedCount","choosenUserId","TextReducer","wrapperRef","useRef","targetRef","originalText","setOriginalText","ready","changed","textData","setTextData","wrapperH","current","clientHeight","targetH","resStr","textWithSpace","ref","CPMain","linkTo","disabled","microEvent","another","PreviewPage","goTo","propsArr","Object","keys","privateMsg","joinToRoom","getMsgs","setMsg","setAddres","setRoom","clear","createNewDialog","unsetDialogId","dialogsComponents","dialogData","showDialogs","searchPeopleClickHandler","some","searchPeoples","searchUser","setDialogTabMod","addQuery","searchValue","setSearchValue","isSearch","focusHandler","bordered","onFocus","onPressEnter","CloseOutlined","SearchOutlined","editProfile","logOut","onEdit","setOnEdit","reset","setReset","inputValue","setInputValue","unsavedParams","nN","lN","pw","resetHandler","values","every","el","danger","LeftOutlined","seted","height","setHeight","wrapper","onresize","style","lastSeen","lastV","personData","setPersonData","keyWord","partnerData","getPollMessages","overflowData","setOverflowData","overflow","dialogIsPicked","scrollHeight","scrollTop","realHeight","onMouseMove","onScroll","TextArea","Input","createMessage","autoSize","inputRef","inputHeight","setInputHeight","App","exact","MessengerPage","render","document","getElementById"],"mappings":"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","file":"static/js/main.d89f5b25.chunk.js","sourcesContent":["export const ADD_TO_CART = 'ADD_TO_CART'\r\nexport const CHECKOUT_REQUEST = 'CHECKOUT_REQUEST'\r\nexport const CHECKOUT_SUCCESS = 'CHECKOUT_SUCCESS'\r\nexport const CHECKOUT_FAILURE = 'CHECKOUT_FAILURE'\r\nexport const RECEIVE_PRODUCTS = 'RECEIVE_PRODUCTS'\r\nexport const MICRO_EVENT = 'MICRO_EVENT'\r\nexport const ADD_ELEMENT = 'ADD_ELEMENT'\r\nexport const PRIVATE_MSG = 'PRIVATE_MSG'\r\nexport const JOIN_TO_ROOM = 'JOIN_TO_ROOM'\r\nexport const GET_MSGS = 'GET_MSGS'\r\nexport const CREATE_DIALOG = 'CREATE_DIALOG'\r\nexport const INIT = 'INIT'\r\nexport const PICK_DIALOG = 'PICK_DIALOG'\r\nexport const SET_DIALOG_TAB_MOD = 'SET_DIALOG_TAB_MOD'\r\nexport const SET_SEARCH_PEOPLE = 'SET_SEARCH_PEOPLE'\r\nexport const CREATE_NEW_DIALOG = 'CREATE_NEW_DIALOG'\r\nexport const CREATE_MESSAGE = 'CREATE_MESSAGE'\r\nexport const SET_MESSAGE = 'SET_MESSAGE'\r\nexport const SET_DIALOG = 'SET_DIALOG'\r\nexport const JOIN_ROOM = 'JOIN_ROOM'\r\nexport const READ_MESSAGES = 'READ_MESSAGES'\r\nexport const SET_READ_MESSAGES = 'SET_READ_MESSAGES'\r\nexport const GET_POLL_MESSAGES = 'GET_POLL_MESSAGES'\r\nexport const SET_V = 'SET_V'\r\nexport const SET_POLL_MESSAGES = 'SET_POLL_MESSAGES'\r\nexport const EDIT_PROFILE = 'EDIT_PROFILE'\r\nexport const SET_PROFILE = 'SET_PROFILE'\r\nexport const SET_MY_PROFILE = 'SET_MY_PROFILE'\r\nexport const SET_ONLINE = 'SET_ONLINE'\r\nexport const LOGOUT = 'LOGOUT'\r\nexport const ADD_QUERY = 'ADD_QUERY'\r\nexport const UNSET_DIALOG_ID = 'UNSET_DIALOG_ID'","import {\r\n  ADD_TO_CART,\r\n  CHECKOUT_REQUEST,\r\n  CHECKOUT_FAILURE,\r\n  CHECKOUT_SUCCESS\r\n} from '@/constants/ActionTypes'\r\n\r\nconst initialState = {\r\n  addedIds: [],\r\n  quantityById: {}\r\n}\r\n\r\nconst addedIds = (state = initialState.addedIds, action) => {\r\n  switch (action.type) {\r\n    case ADD_TO_CART:\r\n      if (state.indexOf(action.productId) !== -1) {\r\n        return state\r\n      }\r\n      return [ ...state, action.productId ]\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nconst quantityById = (state = initialState.quantityById, action) => {\r\n  switch (action.type) {\r\n    case ADD_TO_CART:\r\n      const { productId } = action\r\n      return { ...state,\r\n        [productId]: (state[productId] || 0) + 1\r\n      }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport const getQuantity = (state, productId) =>\r\n  state.quantityById[productId] || 0\r\n\r\nexport const getAddedIds = state => state.addedIds\r\n\r\nconst cart = (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case CHECKOUT_REQUEST:\r\n      return initialState\r\n    case CHECKOUT_FAILURE:\r\n      return action.cart\r\n    case CHECKOUT_SUCCESS:\r\n      console.log('%c%s', 'color: red; font-size: 15px;', 'SUCCESS_SEND')\r\n      return initialState\r\n    default:\r\n      return {\r\n        addedIds: addedIds(state.addedIds, action),\r\n        quantityById: quantityById(state.quantityById, action)\r\n      }\r\n  }\r\n}\r\n\r\nexport default cart\r\n","import { combineReducers } from 'redux'\r\nimport {  MICRO_EVENT, ADD_ELEMENT } from '@/constants/ActionTypes'\r\n\r\nconst prepareTestData = () => {\r\n\r\n  const workStr = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.'\r\n\r\n  const reg = new RegExp('[.]|[,]', 'g');\r\n\r\n  const data = workStr.replace(reg, '').split(' ');\r\n\r\n  let res = []\r\n\r\n  function recurs(pass, path) {\r\n    let name;\r\n    if(pass) {\r\n      name = pass\r\n    } else name = data.splice(0, 1)[0];\r\n    \r\n    if(Math.random() > 0.5 && data.length) {\r\n      let count = Math.floor(Math.min(Math.random()*5, data.length-1))+1;\r\n      let elems = data.splice(0, count);\r\n\r\n      path.push({ name, type:'dir',\r\n        payload: []\r\n      })\r\n      \r\n      elems.forEach(name => recurs(name, path[path.length-1].payload))\r\n\r\n    } else {\r\n      path.push({name, type: 'target', payload: {\r\n        A: Math.random(),\r\n        B: Math.random(),\r\n        C: Math.random()\r\n      }})\r\n    }\r\n  }\r\n\r\n  while(data.length) {\r\n    recurs(null, res)\r\n  }\r\n\r\n  let passData = {name: 'main', type: 'dir', payload: res};\r\n  window.localStorage.testData = JSON.stringify(passData);\r\n  return passData;\r\n}\r\n\r\n\r\nlet parsed = window.localStorage?.testData ?\r\nJSON.parse(window.localStorage?.testData) : prepareTestData() \r\n\r\nconst defState = {\r\n  products: parsed,\r\n}\r\n\r\nconst productsEvents = (state = defState, {type, payload}) => {\r\n  switch(type) {\r\n    case MICRO_EVENT: \r\n      return (() => {\r\n        return state+payload\r\n      })()\r\n    default: \r\n      return state;\r\n  }\r\n}\r\n\r\n\r\nconst microElsDefState = {\r\n  elements: {}\r\n}\r\n\r\nconst microEls = (state = microElsDefState, {type, payload}) => {\r\n  switch(type) {\r\n    case ADD_ELEMENT: \r\n      debugger\r\n      return (() => {\r\n        const {name, A, B, C} = payload;\r\n\r\n        if(state.elements.hasOwnProperty(name)) {\r\n          state.elements[name].count++;\r\n        } else {\r\n          state.elements[name] = {A, B, C, count: 1}\r\n        }\r\n        return state\r\n      })();\r\n    default: \r\n      return state\r\n  }\r\n}\r\n\r\n\r\nexport default combineReducers({\r\n  productsEvents,\r\n  microEls\r\n})\r\n\r\n\r\n","// STATE.V всегда должен быть новым, а иначе старые действия повторяться... \r\n\r\nimport { \r\n  PRIVATE_MSG, \r\n  JOIN_TO_ROOM, \r\n  GET_MSGS, \r\n  INIT,\r\n  PICK_DIALOG,\r\n  SET_DIALOG_TAB_MOD,\r\n  SET_SEARCH_PEOPLE,\r\n  CREATE_NEW_DIALOG,\r\n  CREATE_MESSAGE,\r\n  SET_MESSAGE,\r\n  SET_DIALOG,\r\n  JOIN_ROOM,\r\n  READ_MESSAGES,\r\n  SET_READ_MESSAGES,\r\n  GET_POLL_MESSAGES,\r\n  SET_V,\r\n  SET_POLL_MESSAGES,\r\n  EDIT_PROFILE, \r\n  SET_PROFILE,\r\n  SET_MY_PROFILE,\r\n  SET_ONLINE,\r\n  LOGOUT,\r\n  ADD_QUERY,\r\n  UNSET_DIALOG_ID\r\n} from '@/constants/ActionTypes'\r\n\r\nconst defaultStatus = {\r\n  room: '',\r\n  lastMessage: {addres: '', message: ''},\r\n  v: '',\r\n  dialogs: [],\r\n  user: null,\r\n  isAuth: false,\r\n  choosenDialogId: null,\r\n  readyMessengesData: [],\r\n  dialogTabMod: 'base',\r\n  searchPeople: [],\r\n  newDialogTargetId: null,\r\n  messageData: {},\r\n  isLiveUnreaded: false,\r\n  readMessagesPass: '',\r\n  newProfileData: {},\r\n  logOutId: '',\r\n  showSearchPeople: [],\r\n}\r\n\r\nexport default (state = defaultStatus, {type, payload}) => {\r\n  switch(type) {\r\n    case PRIVATE_MSG: \r\n      return (() => {\r\n        const {msg, addres} = payload;\r\n\r\n        state.lastMessage = {addres, message: msg}\r\n        state.v = getV('m')\r\n        \r\n        return state\r\n      })()\r\n    case JOIN_TO_ROOM:  \r\n      return (() => {\r\n        const {room} = payload;\r\n\r\n        state.room = room;\r\n        state.v = getV('r')\r\n        \r\n        return state \r\n      })()\r\n    case GET_MSGS: // в отдельный сокетовый редюсер\r\n      return (() => {\r\n        state.v = getV('g')\r\n\r\n        return state\r\n      })()\r\n    // case JOIN_ROOM:\r\n    //   return (() => {\r\n    //     debugger\r\n    //     \r\n\r\n    //     state.newDialogTargetId = userId\r\n    //     state.v = getV('joinRoom')\r\n    //     return state\r\n    //   })()\r\n    case CREATE_NEW_DIALOG: // в отдельный сокетовый редюсер\r\n      // может вызваться по персонажу с существующим диалогом\r\n      return (() => {\r\n        const { userId } = payload\r\n\r\n        state.newDialogTargetId = userId // служебка\r\n        state.v = getV('createDialog')\r\n        return state;\r\n      })()\r\n    case SET_DIALOG: \r\n      return (() => {\r\n        const { dialog } = payload\r\n\r\n        state.dialogs.push({\r\n          dialog,\r\n          messages: []\r\n        })\r\n\r\n        state.v = getV()\r\n        return state\r\n      })()\r\n    case CREATE_MESSAGE:\r\n      return (() => {\r\n        const { text } = payload;\r\n        \r\n        const dialog = (() => {\r\n          let dialogInd = -1;\r\n          let i = -1;\r\n          while(++i < state.dialogs.length) {\r\n            if(state.choosenDialogId === state.dialogs[i].dialog['_id']) {\r\n              dialogInd = i;\r\n              break\r\n            }\r\n          }\r\n          return state.dialogs[dialogInd].dialog\r\n        })()\r\n\r\n        state.messageData = {\r\n          poll: dialog.poll,\r\n          dialogId: dialog['_id'],\r\n          userId: state.user['_id'],\r\n          targetUserId: dialog.author['_id'] === state.user['_id'] \r\n            ? dialog.partner['_id'] : dialog.author['_id'],\r\n          text\r\n        }\r\n        state.v = getV('createMessage')\r\n        return state;\r\n      })()\r\n    case SET_MESSAGE: \r\n      return (() => {\r\n        const { message, dialogId } = payload\r\n\r\n        let dialogInd = -1;\r\n        let i = -1;\r\n        while(++i < state.dialogs.length) {\r\n          if(state.dialogs[i].dialog['_id'] === dialogId) {\r\n            dialogInd = i;\r\n            break;\r\n          }\r\n        }\r\n\r\n        state.dialogs[dialogInd].messages.push(message);\r\n\r\n        if(dialogId === state.choosenDialogId) {\r\n          state.readyMessengesData = testFormatMessages(state.dialogs[dialogInd], state.user)\r\n          if(message.author !== state.user['_id']) {\r\n            state.isLiveUnreaded = true\r\n          }\r\n        }\r\n        \r\n        state.v = getV();\r\n        return state\r\n      })()\r\n    case INIT: \r\n      return (() => {\r\n        let {dialogs, user} = payload;\r\n\r\n        state = {...state, dialogs, user, isAuth: true}\r\n        state.v = getV('init')\r\n\r\n        return state\r\n      })()\r\n    case SET_DIALOG_TAB_MOD: // можно отделить\r\n      return (() => {\r\n        const { mod } = payload\r\n        if(mod === 'search') {\r\n          state.dialogTabMod = 'search'\r\n          state.v = getV('searchPeople')\r\n        } else if (mod === 'base') {\r\n          state.dialogTabMod = 'base'\r\n          state.v = getV()\r\n        }\r\n        return state\r\n      })()\r\n    case SET_SEARCH_PEOPLE:\r\n      return (() => {\r\n        const { data } = payload\r\n        \r\n        state.searchPeople = data\r\n        state.showSearchPeople = data\r\n        state.v = getV()\r\n\r\n        return state\r\n      })()\r\n    case ADD_QUERY:\r\n      return (() => {\r\n        const { text } = payload\r\n        state.showSearchPeople = state.searchPeople.filter(({nickName}) => {\r\n          // Символ \"a\" одинаковый в английском и русском алфавитах\r\n          const target = nickName.toLowerCase()\r\n          const searchText = text.toLowerCase()\r\n          const res = target.indexOf(searchText);\r\n          return res !== -1;\r\n        })\r\n\r\n        return state\r\n      })()\r\n    case PICK_DIALOG:\r\n      return (() => {\r\n        const { _id, dialog } = payload\r\n        \r\n        // Вызов через поиск диалогов.\r\n        if(dialog !== null) {\r\n          state.dialogs.push({\r\n            dialog, \r\n            messages: []\r\n          })\r\n        }\r\n\r\n        state.choosenDialogId = _id;\r\n\r\n        let dialogInd = findThatDialog(state.dialogs, _id);\r\n\r\n        const readyMessengesData = testFormatMessages(state.dialogs[dialogInd], state.user)\r\n\r\n        state.readyMessengesData = readyMessengesData;\r\n        state.v = getV('pickDialog')\r\n\r\n        return state\r\n      })()\r\n    case READ_MESSAGES: // moжно вынести как сокет евентер\r\n      return (() => {\r\n        const { pass } = payload\r\n        // пусть подготовка переменных будет на нижнем уровне. \r\n        // приходится добавляеть переменные.. \r\n        state.readMessagesPass = pass\r\n        state.v = getV('readMessages')\r\n        return state\r\n      })()\r\n    case SET_READ_MESSAGES: \r\n      return (() => {\r\n        const { dialogId, messagesId, pass } = payload;\r\n        let dialogInd = findThatDialog(state.dialogs, dialogId);\r\n\r\n        // Обновление данных в диалоге\r\n        let isPartnerMessages = false\r\n\r\n        let i = -1;\r\n        while(++i < state.dialogs[dialogInd].messages.length) {\r\n          let mi = -1;\r\n          while(++mi < messagesId.length) {\r\n            if(state.dialogs[dialogInd].messages[i]['_id'] === messagesId[mi]) {\r\n              state.dialogs[dialogInd].messages[i].readed = true;\r\n              if(state.dialogs[dialogInd].messages[i].author !== state.user['_id']) {\r\n                isPartnerMessages = true\r\n              }\r\n            }\r\n          }\r\n          \r\n        }\r\n\r\n        if(isPartnerMessages) {\r\n          state.isLiveUnreaded = false\r\n        }\r\n\r\n        // побочные действия\r\n        const readyMessengesData = testFormatMessages(state.dialogs[dialogInd], state.user)\r\n        \r\n        state.readyMessengesData = readyMessengesData;\r\n        state.v = getV(pass)\r\n        return state\r\n      })()\r\n    case GET_POLL_MESSAGES:\r\n      return (() => {\r\n        state.v = getV('getPollMessages')\r\n        return state\r\n      })() \r\n    case SET_V: \r\n      return (() => {\r\n        const { pass } = payload;\r\n\r\n        state.v = getV(pass)\r\n        return state\r\n      })()\r\n    case SET_POLL_MESSAGES:\r\n      return (() => {\r\n        const { messages } = payload\r\n        const dialogInd = findThatDialog(state.dialogs, state.choosenDialogId);\r\n\r\n        state.dialogs[dialogInd].messages = [...messages, ...state.dialogs[dialogInd].messages];\r\n\r\n        const readyMessengesData = testFormatMessages(state.dialogs[dialogInd], state.user)\r\n        state.readyMessengesData = readyMessengesData;\r\n        state.v = getV('setPollMessages')\r\n        return state\r\n      })()\r\n    case EDIT_PROFILE: \r\n      return (() => {\r\n        const {nickName, loginName, password} = payload\r\n\r\n        state.newProfileData = {nickName, loginName, password, _id: state.user['_id']}\r\n\r\n        state.v = getV('editProfile')\r\n        return state\r\n      })()\r\n    case SET_MY_PROFILE: \r\n      return (() => {\r\n        state.user = {...state.user, ...state.newProfileData}\r\n\r\n        state.v = getV('setMyProfile')\r\n        return state\r\n      })()\r\n    case SET_PROFILE: \r\n      return (() => {\r\n        const {nickName, loginName, password, _id} = payload\r\n        \r\n\r\n        let i = -1;\r\n        while(++i < state.dialogs.length) {\r\n          const {author, partner} = state.dialogs[i].dialog\r\n          if(author['_id'] === _id) {\r\n            state.dialogs[i].dialog.author = {...state.dialogs[i].dialog.author, nickName, loginName, password}\r\n            break\r\n          }\r\n          if(partner['_id'] === _id) {\r\n            state.dialogs[i].dialog.partner = {...state.dialogs[i].dialog.partner, nickName, loginName, password}\r\n            break\r\n          }\r\n        }\r\n\r\n        state.v = getV('setProfile')\r\n        return state\r\n      })()\r\n\r\n    case SET_ONLINE: \r\n      return (() => {\r\n        const { _id, status } = payload\r\n\r\n        let i = -1;\r\n        while(++i < state.dialogs.length) {\r\n          const {author, partner} = state.dialogs[i].dialog\r\n          if(author['_id'] === _id) {\r\n            state.dialogs[i].dialog.author.online = status\r\n            break\r\n          }\r\n          if(partner['_id'] === _id) {\r\n            state.dialogs[i].dialog.partner.online = status\r\n            break\r\n          }\r\n        }\r\n\r\n        state.v = getV('setOnline')\r\n        return state\r\n      })()\r\n    case LOGOUT: \r\n      return (() => {\r\n        \r\n        const savedId = state.user['_id'];\r\n\r\n        state = defaultStatus;\r\n        state.logOutId = savedId\r\n        state.v = getV('logOut')\r\n        return state\r\n      })()\r\n    case UNSET_DIALOG_ID: \r\n      return (() => {\r\n        state.choosenDialogId = null;\r\n\r\n        state.v = getV()\r\n        return state\r\n      })()\r\n    default: \r\n      return state;\r\n  }\r\n}\r\n\r\nfunction getV(str='') { return `${str}$$${Math.random()}` }\r\n\r\nfunction testFormatMessages({ messages: messagesPass }, user) {\r\n  \r\n  const messages = messagesPass\r\n  .sort(({createdAt: aCT}, {createdAt: bCT}) => {\r\n    if (new Date(aCT) > new Date(bCT)) {\r\n      return 1\r\n    } else {\r\n      return -1\r\n    }\r\n  })\r\n\r\n  const res = [];\r\n  \r\n  let lastDate = {mounth: null, day: null};\r\n\r\n  let i = -1;\r\n  while(++i < messages.length) {\r\n    const { createdAt } = messages[i]\r\n    const workDate = new Date(createdAt);\r\n    const newLastDate = {\r\n      mounth: workDate.getMonth(), \r\n      day: workDate.getDate()\r\n    }\r\n\r\n    if(\r\n      (lastDate.mounth !== newLastDate.mounth) || \r\n      (lastDate.day !== newLastDate.day)\r\n    ) {\r\n      // новая пачка\r\n      lastDate = newLastDate;\r\n      res.push({\r\n        date: getStringDate(newLastDate), \r\n        messages: [getEndpointMessage(messages[i], user)]\r\n      })\r\n    } else {\r\n      // пуш сообщения в старую пачку\r\n      res[res.length - 1].messages.push(\r\n        getEndpointMessage(messages[i], user)\r\n      )\r\n    }\r\n\r\n  }\r\n\r\n    \r\n\r\n  return res\r\n\r\n  function getStringDate ({mounth, day}) {\r\n    const mounthNames = {\r\n      '0': 'January ',\r\n      '1': 'February',\r\n      '2': 'March',\r\n      '3': 'April',\r\n      '4': 'May',\r\n      '5': 'June',\r\n      '6': 'Jule',\r\n      '7': 'August',\r\n      '8': 'September',\r\n      '9': 'October',\r\n      '10': 'November',\r\n      '11': 'December'\r\n    }\r\n    return `${day} ${mounthNames[mounth+'']}`\r\n  }\r\n\r\n  function getEndpointMessage(messages, user) {\r\n    const { text, author, createdAt, readed, prevPoll } = messages\r\n    const workDate = new Date(createdAt);\r\n    const resTime = `${workDate.getHours()}:${workDate.getMinutes()}`\r\n    const resObject = {\r\n      time: resTime,\r\n      text, \r\n      isMe: author === user['_id'],\r\n      readed,\r\n      prevPoll\r\n    }\r\n    return resObject\r\n  }\r\n  \r\n}\r\n\r\nfunction findThatDialog(dialogs, id) {\r\n  let resInd = -1;\r\n\r\n  let i = -1;\r\n  while(++i < dialogs.length) {\r\n    if(dialogs[i].dialog['_id'] === id) {\r\n      resInd = i;\r\n      break\r\n    }\r\n  }\r\n  return resInd\r\n}","import { combineReducers } from 'redux'\r\nimport cart from './cart'\r\nimport products from './products'\r\nimport dialogs from './dialogs'\r\n\r\nexport default combineReducers({\r\n  cart,\r\n  products,\r\n  dialogs\r\n})\r\n","import { notification } from 'antd'\r\n\r\nconst openNotification = ({type, title, description}) => {\r\n  notification[type]({\r\n    message: title, \r\n    description\r\n  })\r\n}\r\n\r\nexport default openNotification","const upFirstSimbol = (string) => {\r\n  return string.charAt(0).toUpperCase()+string.substring(1);\r\n}\r\n\r\nexport default upFirstSimbol","import axios from 'axios'\r\n\r\naxios.defaults.baseURL = window.location.origin; //  'http://localhost:3000'\r\naxios.defaults.headers.common['token'] = localStorage.token;\r\n\r\nwindow.axios = axios;\r\n\r\nexport default axios;","import axios from '../axios';\r\n\r\nexport default {\r\n  login: (data) => axios.post('/auth/login', data),\r\n  register: (data) => axios.post('/auth/register', data),\r\n  checkToken: () => axios.post('/auth/check') \r\n}","import { auth } from '@/core/api';\r\nimport { openNotification, upFirstSimbol } from '@/utils'\r\nimport * as types from '@/constants/ActionTypes';\r\n \r\nconst dataInit = payload => ({\r\n  type: types.INIT,\r\n  payload\r\n})\r\n\r\nconst effecter = ({status, token, data, message}, isTokenLogin = false) => dispatch => {\r\n  if(status === 'success') {\r\n    localStorage.token = token;\r\n    window.axios.defaults.headers.common['token'] = token;\r\n    openNotification({type: status, title: upFirstSimbol(status), description: message});\r\n    dispatch(dataInit(data))\r\n  } else {\r\n    openNotification({type: status, title: upFirstSimbol(status), description: message})\r\n    isTokenLogin && delete localStorage.token\r\n  }\r\n}\r\n\r\nexport const loginUser = data => dispatch => {\r\n  auth.login(data).then(({data}) => {\r\n    console.log('%c%s', 'font-size: 22px; color: navy;', 'SERVER_RES')\r\n    console.log('RES:', data);\r\n\r\n    effecter(data)(dispatch)\r\n  }).catch(er => {\r\n    console.log('%c%s', 'color: red;font-size:22px;', 'AXIOS_LOGIN_ERR:', er)\r\n  })\r\n}\r\n\r\nexport const createUser = data => dispatch => {\r\n  auth.register(data).then(({data}) => {\r\n    console.log('%c%s', 'font-size: 22px; color: navy;', 'SERVER_RES')\r\n    console.log('RES_DEST:', data);\r\n\r\n    effecter(data)(dispatch)\r\n  }).catch(er => {\r\n    console.log('%c%s', 'color: red;font-size:22px;', 'AXIOS_REGISTER_ERR:', er)\r\n  })\r\n}\r\n\r\nexport const checkAuth = () => dispatch => {\r\n  auth.checkToken().then(({data}) => {\r\n    \r\n    console.log('%c%s', 'font-size: 22px; color: navy;', 'SERVER_RES')\r\n    console.log('RES_CHECK:', data);\r\n\r\n    effecter(data, true)(dispatch)\r\n  })\r\n  .catch(er => {\r\n    console.log('%c%s', 'color: red;font-size:22px;', 'AXIOS_AUTO_LOGIN_ERR:', er)\r\n  })\r\n}\r\n\r\n/* \r\nИмееться \"работающая\" авторизация на сервере.. данные доходят, но дальще\r\nне обрабатываются. JWT функционирует нормально. Необходимо обновлять Axios.headers\r\nв ручную, а иначе он поднимает старый токен.\r\n\r\nЛогин так же успешно работает и доставляет необходимую информацию.\r\n\r\n*/","import * as types from '../constants/ActionTypes'\r\nimport store from '@/store'\r\n\r\nexport const microEvent = () => ({\r\n  type: types.MICRO_EVENT,\r\n  payload: Math.random()\r\n})\r\n\r\nexport const addElement = (obj) => ({\r\n  type: types.ADD_ELEMENT,\r\n  payload: obj\r\n})\r\n\r\nexport const privateMsg = (payload) => ({\r\n  type: types.PRIVATE_MSG, \r\n  payload\r\n})\r\n\r\nexport const joinToRoom = (payload) => ({\r\n  type: types.JOIN_TO_ROOM,\r\n  payload\r\n})\r\n\r\nexport const getMsgs = () => ({\r\n  type: types.GET_MSGS\r\n})\r\n\r\nexport const pickDialog = (_id, dialog = null) => ({\r\n  type: types.PICK_DIALOG,\r\n  payload: { _id, dialog }\r\n})\r\n\r\nexport const setDialogTabMod = (mod) => ({\r\n  type: types.SET_DIALOG_TAB_MOD,\r\n  payload: { mod }\r\n})\r\n\r\nexport const setSearchPeople = (data) => ({\r\n  type: types.SET_SEARCH_PEOPLE,\r\n  payload: { data }\r\n})\r\n\r\nexport const createNewDialog = (id = null) => ({\r\n  type: types.CREATE_NEW_DIALOG,\r\n  payload: { userId: id }\r\n})\r\n\r\nexport const createMessage = (text) => ({\r\n  type: types.CREATE_MESSAGE,\r\n  payload: { text }\r\n})\r\n\r\nexport const setMessage = (message, dialogId) => ({\r\n  type: types.SET_MESSAGE,\r\n  payload: { message, dialogId }\r\n})\r\n\r\nexport const setDialog = (dialog) => ({\r\n  type: types.SET_DIALOG,\r\n  payload: { dialog }\r\n})\r\n\r\nexport const joinRoom = userId => ({\r\n  type: types.JOIN_ROOM,\r\n  payload: { userId }\r\n})\r\n\r\nexport const readMessages = (pass = '') => ({\r\n  type: types.READ_MESSAGES,\r\n  payload: { pass }\r\n})\r\n\r\nexport const setReadMessages = (dialogId, messagesId, pass) => ({\r\n  type: types.SET_READ_MESSAGES,\r\n  payload: { dialogId, messagesId, pass }\r\n})\r\n\r\nexport const getPollMessages = () => ({\r\n  type: types.GET_POLL_MESSAGES\r\n})\r\n\r\nexport const setV = (pass) => ({\r\n  type: types.SET_V,\r\n  payload: { pass }\r\n})\r\n\r\nexport const setPollMessages = (messages) => ({\r\n  type: types.SET_POLL_MESSAGES,\r\n  payload: { messages }\r\n})\r\n\r\nexport const editProfile = ({nickName, loginName, password}) => ({\r\n  type: types.EDIT_PROFILE,\r\n  payload: {nickName, loginName, password}\r\n})\r\n\r\nexport const setProfile = ({nickName, loginName, password, _id}) => ({\r\n  type: types.SET_PROFILE,\r\n  payload: {nickName, loginName, password, _id}\r\n})\r\n\r\nexport const setMyProfile = () => ({ // служебка. Нужно отделять такие\r\n  type: types.SET_MY_PROFILE\r\n})\r\n\r\nexport const setOnline = (_id, status) => ({\r\n  type: types.SET_ONLINE,\r\n  payload: { _id, status }\r\n})\r\n\r\nexport const logOut = () => ({\r\n  type: types.LOGOUT\r\n})\r\n\r\nexport const addQuery = (text) => ({\r\n  type: types.ADD_QUERY,\r\n  payload: { text }\r\n})\r\n\r\nexport const unsetDialogId = () => ({\r\n  type: types.UNSET_DIALOG_ID\r\n})\r\n\r\n\r\nexport {createUser, loginUser, checkAuth} from './network'","import { io } from 'socket.io-client';\r\nimport { createStore, applyMiddleware, compose } from 'redux'\r\nimport { useHistory } from 'react-router-dom'\r\n\r\nimport { createLogger } from 'redux-logger'\r\nimport thunk from 'redux-thunk'\r\nimport reducer from './reducers'\r\n\r\nimport { openNotification } from '@/utils'\r\n\r\nimport { \r\n  setSearchPeople, \r\n  pickDialog, \r\n  setMessage, \r\n  setDialog,\r\n  readMessages,\r\n  setReadMessages,\r\n  setV,\r\n  setPollMessages,\r\n  setProfile, \r\n  setMyProfile,\r\n  setOnline,\r\n  \r\n} from '@/actions'\r\n\r\nconst middleware = [ thunk ];\r\nif (process.env.NODE_ENV !== 'production') {\r\n  middleware.push(createLogger());\r\n}\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n\r\nconst store = createStore(\r\n  reducer,\r\n  composeEnhancers(applyMiddleware(...middleware))\r\n)\r\n// 'http://localhost:3000'\r\nconst socket = io(window.location.origin, {transports: ['websocket']}); \r\n\r\nsocket\r\n  .on('connect', (ev) => {\r\n    socket.emit('MSG', {data: 'pass', token: \"123\"})\r\n  })\r\n  .on('CLIENT_MSG', (pass) => {\r\n    console.log('%c%s', 'font-size: 22px; color: red;', pass)\r\n  })\r\n  .on('RES_PRIVATE_MSG', (pass) => {\r\n    console.log('%c%s', 'font-size: 22px; color: navy;', 'PRIVATE_MSG');\r\n    console.log('Message:', pass);\r\n\r\n    \r\n    // cb()\r\n  })\r\n  .on('RES_MSGS', data =>  {\r\n    console.log('%c%s', 'font-size: 22px; color: aqua;', 'GET_MSGS');\r\n    console.log('Data:', data)\r\n  })\r\n  .on('RES_PEOPLE', data => {\r\n    store.dispatch(setSearchPeople(data))\r\n  })\r\n  .on('RES_NEW_DIALOG', ({dialog, target}) => {\r\n    if(target === 'me') {\r\n      store.dispatch(pickDialog(dialog['_id'], dialog))\r\n    } else {\r\n      store.dispatch(setDialog(dialog))\r\n    }\r\n    \r\n  })\r\n  .on('RES_MESSAGE', ({message, dialogId}) => {\r\n    store.dispatch(setMessage(message, dialogId))\r\n  })\r\n  .on('SET_READ_MESSAGE', ({dialogId, messagesId, pass }) => {\r\n    store.dispatch(setReadMessages(dialogId, messagesId, pass))\r\n  })\r\n  .on('RES_POLL_MESSAGES', ({messages}) => {\r\n    store.dispatch(setPollMessages(messages))\r\n  })\r\n\r\n  .on('BAD_EDIT_PROFILE', ({message}) => {\r\n    openNotification({type: 'error', title: 'Error', description: message})\r\n  })\r\n  .on('SET_PROFILE', ({newProfileData}) => {\r\n    store.dispatch(setProfile(newProfileData))\r\n  })\r\n  .on('SET_MY_PROFILE', () => {\r\n    store.dispatch(setMyProfile())\r\n  })\r\n\r\n  .on('SET_ONLINE', ({_id, status}) => {\r\n    store.dispatch(setOnline(_id, status))\r\n  })\r\n  \r\n  .on('disconnect', (reason) => {\r\n    console.log('%c%s', 'font-size: 22px; color: crimson;', 'DISCON:')\r\n    console.log('Reason:',reason);\r\n  })\r\n\r\n\r\nlet lastV = '';\r\n\r\nstore.subscribe(() => {\r\n  const freshState = store.getState();\r\n  const {\r\n    lastMessage: {addres, message}, \r\n    room,  \r\n    v,\r\n    newDialogTargetId,\r\n    messageData,\r\n    dialogs,\r\n    choosenDialogId,\r\n    user,\r\n    readyMessengesData,\r\n    readMessagesPass,\r\n    newProfileData,\r\n    logOutId\r\n  } = freshState.dialogs;\r\n\r\n  const token = localStorage.token;\r\n\r\n  // какого черта это было... Почему он проходил?\r\n  if(lastV !== v) {\r\n    \r\n    let checkSimbol = v.split('$$')[0];\r\n    \r\n    switch(checkSimbol) {\r\n      case 'r': \r\n        (() => {\r\n          \r\n          socket.emit('JOIN_ROOM', { token, room }, (data) => {\r\n            console.log('%c%s', 'font-size: 22px; color: green;', 'SUCCESS_JOIN');\r\n            console.log('Rooms:', data);\r\n          })\r\n\r\n        })();\r\n        break;\r\n      case 'm': \r\n        (() => {\r\n         \r\n          socket.emit('PRIVATE_MSG', {\r\n            token,\r\n            payload: { addres, message }\r\n          }, (lastRooms) => {\r\n            console.log('%c%s', 'font-size: 22px; color: green;', 'SUCCESS_SEND_MSG');\r\n            console.log('%c%s', 'font-size: 22px; color: aqua;', 'LAST_ROOMS:', lastRooms)\r\n          })\r\n          \r\n        })();\r\n        break;\r\n      case 'g':\r\n        (() => {\r\n          console.log('SUB')\r\n          socket.emit('GET_MSGS', {\r\n            token\r\n          });\r\n        })()\r\n        break;\r\n      case 'init':\r\n        (() => {\r\n          socket.emit('JOIN', { token }, (rooms) => {\r\n            console.log('%c%s', 'font-size: 22px; color: green;', 'SUCCESS_JOIN', rooms);\r\n          })\r\n        })();\r\n        break\r\n      case 'searchPeople':\r\n        (() => {\r\n          socket.emit('GET_PEOPLE', {\r\n            token\r\n          })\r\n        })()\r\n        break\r\n      // case 'joinRoom':\r\n      //   debugger\r\n      //   (() => {\r\n      //     socket.emit('JOIN_ROOM', {\r\n      //       token, room: newDialogTargetId,\r\n      //     })\r\n      //   })()\r\n      //   break\r\n      case 'createDialog': \r\n        (() => {\r\n          socket.emit('CREATE_NEW_DIALOG', {\r\n            token,\r\n            newDialogTargetId\r\n          })\r\n          \r\n        })()\r\n        break\r\n      case 'createMessage': \r\n        (() => {\r\n          socket.emit('CREATE_MESSAGE', {...messageData, token})\r\n        })()\r\n        break\r\n      case 'readMessages':  // просто исполняемый код.. без проверок.. \r\n        (() => {\r\n          \r\n          let dialogInd = -1;\r\n          while(++dialogInd < dialogs.length) {\r\n            if(dialogs[dialogInd].dialog['_id'] === choosenDialogId) {\r\n              break\r\n            }\r\n          }\r\n\r\n          \r\n\r\n          const targetUserId = dialogs[dialogInd].dialog.partner['_id'] === user['_id']\r\n          ? dialogs[dialogInd].dialog.author['_id']\r\n          : dialogs[dialogInd].dialog.partner['_id']\r\n          // можно оптимизировать через реверс\r\n\r\n          let partnerUnreadedMessagesIds = dialogs[dialogInd].messages\r\n          .filter(({readed, author}) => !readed && author === targetUserId).map(({_id}) => _id)\r\n\r\n          if(partnerUnreadedMessagesIds.length) {\r\n            socket.emit('READ_MESSAGE', { token, \r\n              dialogId: choosenDialogId, \r\n              messagesId: partnerUnreadedMessagesIds,\r\n              targetUserId,\r\n              pass: readMessagesPass,\r\n            })\r\n          } else {\r\n            store.dispatch(setV('pickEvent'))\r\n          }\r\n        })()\r\n        break\r\n      case 'getPollMessages':\r\n        (() => {\r\n          const poll = readyMessengesData['0'].messages['0'].prevPoll\r\n          \r\n          socket.emit('GET_POLL_MESSAGES', { poll, token })\r\n        })()\r\n        break\r\n      case 'editProfile': \r\n        (() => {\r\n          socket.emit('EDIT_PROFILE', { token, newProfileData })\r\n        })()\r\n        break\r\n      case 'logOut': \r\n        (() => {\r\n          socket.emit('LOGOUT', {_id: logOutId}, () => {\r\n            \r\n          })\r\n        })()\r\n      default:\r\n        break\r\n    }\r\n\r\n    switch(checkSimbol) {\r\n      case 'pickDialog':\r\n        (() => {\r\n          store.dispatch(readMessages('pickEvent'))\r\n        })()\r\n        break\r\n      default:\r\n        break\r\n    }\r\n  }\r\n\r\n})\r\n  \r\n\r\nexport default store","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { useLocation, Link } from 'react-router-dom'\r\n\r\nimport './Bread.scss'\r\n\r\nconst Bread = props => {\r\n\r\n  const {pathname} = useLocation();\r\n\r\n  const paths = pathname.split('/').splice(1)\r\n  \r\n  function preparePaths(arr = paths) {\r\n    const res = [];\r\n    let i = -1;\r\n\r\n    let sumPath = ''\r\n\r\n    while(++i < arr.length) {\r\n      let pathDls = `/${arr[i]}`;\r\n      res.push({text: arr[i], path: sumPath+pathDls});\r\n\r\n      sumPath+=pathDls;\r\n    }\r\n\r\n    return res\r\n  }\r\n\r\n  const readyPaths = preparePaths()\r\n  debugger\r\n  return (\r\n    <div className={'bread'}>\r\n      {readyPaths.map(({path, text}) => \r\n      <li className={'bread_links'}>\r\n        <Link to={path}>{text}</Link>\r\n      </li>)}\r\n    </div>\r\n  )\r\n}\r\n\r\nBread.propTypes = {\r\n\r\n}\r\n\r\nexport default Bread\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nconst Search = props => {\r\n  return (\r\n    <div>\r\n      {\"Search\"}\r\n    </div>\r\n  )\r\n}\r\n\r\nSearch.propTypes = {\r\n\r\n}\r\n\r\nexport default Search\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport classNames from 'classnames'\r\nimport { useHistory } from 'react-router-dom'\r\n\r\nimport './Target.scss'\r\n\r\nconst Target = ({onClick, text, src = null, type}) => {\r\n  console.log('RENDER_Target');\r\n\r\n  const history = useHistory();\r\n  const path = `${history.location.pathname}/${text}`;\r\n\r\n  function clickHandler() {\r\n    if(type === 'dir') {\r\n      history.push(path)\r\n    } else {\r\n      onClick();\r\n    }\r\n  }\r\n\r\n\r\n\r\n  return (\r\n    <div className={classNames('target', type === 'target' && 'clickable')} \r\n        onClick={clickHandler}>\r\n      {\r\n        src ? <img src={src} /> : null\r\n      }\r\n      <div className={'target_text'}>\r\n        {text}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nTarget.propTypes = {\r\n\r\n}\r\n\r\nexport default Target\r\n","import React from 'react'\r\n\r\nimport { Tag } from 'antd'\r\n\r\nimport './CheckTags.scss';\r\n\r\nconst { CheckableTag } = Tag;\r\nconst CheckTags = ({fValue, sValue, fHandl, sHandl, checkParam}) => {\r\n\r\n  return (\r\n    <div className='checkTags'>\r\n      <CheckableTag \r\n        onClick={() => !checkParam && fHandl()}\r\n        checked={checkParam}>\r\n        {fValue}\r\n      </CheckableTag>\r\n      <CheckableTag\r\n        onClick={() => checkParam && sHandl()}\r\n        checked={!checkParam}>\r\n        {sValue}\r\n      </CheckableTag>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default CheckTags","import React from 'react'\r\nimport classNames from 'classnames'\r\n\r\nimport './Message.scss'\r\n\r\nconst Message = ({text, time, isMe = true, readed = false}) => {\r\n\r\n  const styleEffect = isMe?'-isMe':'-isPartner'\r\n  return (\r\n    <section className={classNames('message', `message${styleEffect}`)}>\r\n      <div className={classNames('message__cloud', `message__cloud${styleEffect}`)}>\r\n        <div className={'message__cloud_payload'}>\r\n          {text}\r\n        </div>\r\n        <div className={classNames('message__cloud_time', `message__cloud_time${styleEffect}`)}>\r\n          {time}\r\n        </div>\r\n      </div>\r\n      {(isMe && !readed) ? <div className={'message__unreaded'} >{''}</div> : null}\r\n    </section>\r\n  )\r\n}\r\n\r\n\r\nexport default Message","import React from 'react'\r\n\r\nimport './DateElement.scss'\r\n\r\nconst DateElement = ({date='13 February'}) => {\r\n  return (\r\n    <section className='dateElement'>\r\n      <div className='dateElement__target'>\r\n        {date}\r\n      </div>\r\n    </section>\r\n  )\r\n}\r\n\r\nexport default DateElement\r\n","import React from 'react'\r\nimport { useHistory } from 'react-router-dom'\r\n\r\nimport { MenuOutlined } from '@ant-design/icons'\r\n\r\nimport './MenuButton.scss'\r\n\r\nconst MenuButton = () => {\r\n  const history = useHistory();\r\n\r\n  function goToHomeHandler() {\r\n    history.push('/')\r\n  }\r\n\r\n  return (\r\n    <section className='menuButton' onClick={goToHomeHandler}>\r\n      <MenuOutlined />\r\n    </section>\r\n  )\r\n}\r\n\r\n\r\nexport default MenuButton","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport { Bread } from '@@/components'\r\n\r\nimport './Header.scss'\r\n\r\nconst CPHeader = props => {\r\n  return (\r\n    <section className={'cPHeader'}>\r\n      <div className={'cPHeader_rightSpace'} />\r\n        <div className={'cPHeader__main'}>\r\n          <Bread />\r\n        </div>\r\n        <div className={'cPHeader_rightSpace'}>\r\n          <Link to={'/result'} >{\"Result\"}</Link>\r\n        </div>\r\n    </section>\r\n  )\r\n}\r\n\r\nCPHeader.propTypes = {\r\n\r\n}\r\n\r\nexport default CPHeader\r\n","import React, { useState } from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { Route, Switch, useLocation } from 'react-router-dom'\r\nimport { connect } from 'react-redux'\r\n\r\nimport { Target } from '@@/components'\r\n\r\nimport { addElement } from '@/actions';\r\n\r\nimport './ChooseBoard.scss'\r\n\r\nconst ChooseBoard = (\r\n  {\r\n    productsEvents = {}, \r\n    rightPass = false, \r\n    link = false, \r\n    \r\n    addElement\r\n  }) => {\r\n\r\n  const products = productsEvents?.products || null\r\n  if(!rightPass) {\r\n    rightPass = products\r\n  }\r\n\r\n  const [routes, setRoutes] = useState(null)\r\n\r\n  // let str = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent lobortis quis libero non luctus.'\r\n\r\n  // const reg = new RegExp('[.]|[,]', 'g')\r\n\r\n  // const data = str.replace(reg, '').split(' ')\r\n  const { pathname } = useLocation();\r\n\r\n  const getLastElem = path => {let ar = path.split('/'); return ar[ar.length-1]}\r\n\r\n\r\n  if(routes === null) {\r\n    let res = rightPass.payload.map(({name, type}, i) => {\r\n      return type === 'dir' \r\n      ? <Route path={`${pathname}/${name}`}>\r\n        <ChooseBoard rightPass={rightPass.payload[i]} link={name} addElement={addElement}/>\r\n      </Route>\r\n      : null\r\n    });\r\n\r\n    setRoutes(res);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      { rightPass.name === getLastElem(pathname) ?\r\n          <div className={'chooseBoard'}>\r\n            {rightPass.payload.map(({name, type, payload}) => {\r\n              return <Target text={name} type={type} onClick={() => addElement({name, ...payload})} />\r\n            })}\r\n          </div>\r\n        : null\r\n      }\r\n      \r\n      <Switch>\r\n        {routes}\r\n      </Switch>\r\n    </>\r\n  )\r\n}\r\n\r\nChooseBoard.propTypes = {\r\n\r\n}\r\n\r\nconst mapState = ({products}, {link}) => {\r\n  debugger\r\n  return {\r\n    productsEvents: !link ? products.productsEvents : {products: false}\r\n  }\r\n}\r\n\r\nexport default connect(mapState, {addElement})(ChooseBoard);\r\n","import React, { useState, useEffect } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport classNames from 'classnames'\r\nimport { useHistory, useLocation } from 'react-router-dom'\r\n\r\nimport { createUser, loginUser, checkAuth } from '@/actions'\r\n\r\nimport { Button, Input, message } from 'antd'\r\n\r\nimport { CheckTags } from '@@/components'\r\n\r\nimport './Login.scss';\r\n\r\nexport const LoginPage = (\r\n  { isAuth,\r\n\r\n    createUser, \r\n    loginUser, \r\n    checkAuth \r\n  }) => {\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n\r\n  const [workPlace, setWorkPlace] = useState('create');\r\n  const [data, setData] = useState({nickName: '', password: '', passwordConfirm: ''})\r\n  const { nickName, password, passwordConfirm } = data;\r\n\r\n  useEffect(() => {\r\n    \r\n    localStorage?.token && !isAuth && checkAuth();\r\n    isAuth && localStorage?.token && (() => {\r\n      \r\n      const { from } = location.state || { from: {pathname: \"/messenger\"} }\r\n      history.replace(from)\r\n    })();\r\n\r\n    return () => {\r\n\r\n    }\r\n  })\r\n\r\n\r\n  function sumbitHandl(ev) {\r\n    ev.preventDefault();\r\n    let errors = false;\r\n\r\n    if(password.length < 3) {\r\n      errors = true\r\n      message.error('Password too short', 3);\r\n    }\r\n    if(nickName.length < 3) {\r\n      errors = true\r\n      message.error('Nickname too short', 3);\r\n    }\r\n\r\n    if(workPlace === 'create') {\r\n      if(passwordConfirm !== password) {\r\n        errors = true;\r\n        message.error('Passwords are not equal', 3);\r\n      }\r\n      !errors && createUser(data);\r\n    } else {\r\n      !errors && loginUser(data);\r\n    }\r\n  }\r\n\r\n  const chechProps = {\r\n    fValue: 'LOGIN',\r\n    sValue: 'CREATE NEW',\r\n    fHandl: () => setWorkPlace('login'),\r\n    sHandl: () => setWorkPlace('create'),\r\n    checkParam: workPlace === 'login'\r\n  }\r\n\r\n  return (\r\n    <div className='login'>\r\n      <div className='login__checkTags'>\r\n        <CheckTags {...chechProps} />\r\n      </div>\r\n      <div className='login__form'>\r\n        <form onSubmit={sumbitHandl}>\r\n          <div className={classNames('formElement')}>\r\n            <Input \r\n              placeholder={'Nickname'}\r\n              onChange={ev => setData({...data, nickName: ev.target.value})}\r\n              value={nickName}/>\r\n          </div>\r\n          <div className={classNames('formElement')}>\r\n            <Input.Password \r\n              placeholder={'Password'}\r\n              onChange={ev => setData({...data, password: ev.target.value})}\r\n              value={password}/>\r\n          </div>\r\n          {\r\n            workPlace === 'create' &&\r\n            <div className={classNames('formElement')}>\r\n              <Input.Password \r\n                placeholder={'Password confirm'}\r\n                onChange={ev => setData({...data, passwordConfirm: ev.target.value})}\r\n                value={passwordConfirm}/>\r\n            </div>\r\n          }\r\n          <div className={classNames('formElement', 'login__form_submit')}>\r\n            <Button onClick={ev => console.log('click')} htmlType=\"submit\">\r\n              {\"SEND DATA\"}\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = ({dialogs: {isAuth}}) => ({\r\n  isAuth\r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  createUser, loginUser, checkAuth\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(LoginPage)\r\n","import React from 'react'\r\nimport classNames from 'classnames'\r\n\r\nimport { TextReducer } from '@@/containers'\r\n\r\nimport './Dialog.scss';\r\n\r\nconst  DialogView = (\r\n  {\r\n    imgPlug, \r\n    name, \r\n    messange, \r\n    infoCount, \r\n    online,\r\n    messageDls,\r\n    authorIsYou,\r\n    isSearchPeopleMod = false,\r\n    isChoosen,\r\n\r\n    clickHandler\r\n  }) => {\r\n  return (\r\n    <section className={classNames(\r\n      'dialog', isChoosen \r\n      ? 'dialog__isChoosen' : null\r\n    )} \r\n      onClick={clickHandler}>\r\n      <div className='dialog__leftPart'>\r\n        <div className='dialog__leftPart_imgPlug'>{imgPlug}</div>\r\n        {online && <div className='dialog__leftPart_online'>{''}</div>}\r\n      </div>\r\n      <div className='dialog__rightPart'>\r\n        <div className='dialog__rightPart_name'>\r\n          {name}\r\n        </div>\r\n        {!isSearchPeopleMod\r\n          ? <div className='dialog__rightPart_message'>\r\n              <div className='dialog__rightPart_message-payload'>\r\n                <TextReducer text={`${authorIsYou?'You: ':''}${messange}`} />\r\n              </div>\r\n              <div className='infoCountWrapper'>\r\n                <div className={`dialog__rightPart_message${messageDls}`}>\r\n                  {infoCount}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          : null\r\n        }\r\n        \r\n      </div>\r\n    </section>\r\n  )\r\n}\r\n\r\nexport default DialogView\r\n","import React from 'react'\r\nimport { connect } from 'react-redux'\r\n\r\nimport View from '../view'\r\n\r\nexport const Dialog = (\r\n  {\r\n    dialog,\r\n    messages,\r\n    me,\r\n    choosenId,\r\n\r\n    onClick\r\n  }) => {\r\n  \r\n  // Все это.. можно и нужно перенести в редюсер\r\n  let showData;\r\n  const showTarget = dialog.author['_id'] === me['_id']\r\n  ? dialog.partner : dialog.author\r\n  \r\n  const isChoosen = dialog['_id'] === choosenId;\r\n\r\n  if(messages.length) {\r\n\r\n    const readed = messages[messages.length-1].readed;\r\n    const authorIsYou = messages[messages.length-1].author === me['_id'];\r\n\r\n    function getMessageDls() {\r\n      const numbReaded = +readed,\r\n      numbAuthorIsYou = +authorIsYou,\r\n      chooseTree = {\r\n        '0': {'0': '-infoCount', '1': '-none'},\r\n        '1': {'0': '-unreaded', '1': '-none'}\r\n      }\r\n      return chooseTree[numbAuthorIsYou][numbReaded]\r\n    }\r\n    const messageDls = getMessageDls();\r\n    \r\n    function getUnreadedCount() {\r\n      \r\n      const revMessages = messages.reverse();\r\n\r\n      let resCount = 0\r\n      let deathFlag = false;\r\n      while(!deathFlag && (resCount < revMessages.length)) {\r\n        if(!revMessages[resCount].readed) {\r\n          resCount++;\r\n        } else {\r\n          deathFlag = true\r\n        }\r\n      }\r\n      if(resCount >= 10) {\r\n        return '9+'\r\n      } else return resCount;\r\n    }\r\n\r\n    showData = {\r\n      imgPlug: showTarget.nickName[0],\r\n      name: showTarget.nickName,\r\n      messange: messages[messages.length-1].text,\r\n      infoCount: messageDls === '-infoCount' ? getUnreadedCount() : null,\r\n      online: showTarget.online,\r\n      authorIsYou, \r\n      messageDls,\r\n      isChoosen\r\n    }\r\n\r\n  } else {\r\n    showData = {\r\n      imgPlug: showTarget.nickName[0],\r\n      name: showTarget.nickName,\r\n      messange: '',\r\n      infoCount: null,\r\n      online: showTarget.online,\r\n      authorIsYou: false,\r\n      messageDls: '-none',\r\n      isChoosen\r\n    }\r\n  }\r\n\r\n  \r\n\r\n  return (\r\n    <View {...showData} \r\n      clickHandler={() => !isChoosen && onClick(dialog['_id'])} \r\n      />\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  \r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  \r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Dialog)\r\n","import React from 'react'\r\nimport { connect } from 'react-redux'\r\n\r\nimport View from '../view'\r\n\r\nexport const SearchPeopleWrapper = (\r\n  {\r\n    user,\r\n    choosenUserId,\r\n\r\n    onClick\r\n  }) => {\r\n  \r\n  // Все это.. можно и нужно перенести в редюсер\r\n  \r\n  const showTarget = user\r\n\r\n  const isChoosen = user['_id'] === choosenUserId;\r\n\r\n  const showData = {\r\n    imgPlug: showTarget.nickName[0],\r\n    name: showTarget.nickName,\r\n    clickHandler: () => !isChoosen && onClick(showTarget['_id']),\r\n    online: showTarget.online,\r\n    isSearchPeopleMod: true,\r\n    isChoosen\r\n  }\r\n\r\n  return (\r\n    <View {...showData} />\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  \r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  \r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchPeopleWrapper)\r\n","import React, { useRef, useEffect, useState } from 'react'\r\n\r\nimport './TextReducer.scss'\r\n\r\n const TextReducer = ({text}) => {\r\n  const wrapperRef = useRef(null);\r\n  const targetRef = useRef(null);\r\n  const [originalText, setOriginalText] = useState(null);\r\n  const [textData, setTextData] = useState({\r\n    payload: text,\r\n    ready: false, \r\n    changed: false,\r\n  })\r\n\r\n  useEffect(() => {\r\n    if(originalText !== text) { // ручное обновление главного пропса\r\n      setOriginalText(text);\r\n      setTextData({payload: text, ready: false, changed: false})\r\n    }\r\n\r\n    const { clientHeight: wrapperH } = wrapperRef.current,\r\n    { clientHeight: targetH } = targetRef.current,\r\n    {payload, ready, changed} = textData;\r\n\r\n    if(targetH > wrapperH) {\r\n      let resStr = payload.substring(0, 0.85*payload.length/(targetH/wrapperH));\r\n      setTextData({...textData, payload: resStr, changed: true })\r\n    } else if(!ready) {\r\n      let textWithSpace = payload\r\n      textWithSpace = changed \r\n        ? `${textWithSpace.substring(0, payload.length-3)}...`\r\n        : textWithSpace;\r\n      setTextData({...textData, payload:textWithSpace, ready: true})\r\n    }\r\n\r\n  })\r\n\r\n\r\n\r\n  return (\r\n    <div ref={wrapperRef} className='textReducer'>\r\n      <div ref={targetRef} className='textReducer__target'>\r\n        {textData.payload}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default TextReducer","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport { Search } from '@@/components'\r\nimport { ChooseBoard } from '@@/containers'\r\n\r\nimport './Main.scss';\r\n\r\nconst CPMain = ({microEvent}) => {\r\n  return (\r\n    <section className={'cPMain'}>\r\n      <div className={'cPMain_leftSpace'} />\r\n      <div className={'cPMain_main'}>\r\n        <Search />\r\n        <ChooseBoard />\r\n        {/* <button onClick={() => microEvent()}>\r\n        {'ChoosePage'}\r\n        </button>\r\n        <Link to='/result'>\r\n          {'toResult'}\r\n        </Link> */}\r\n      </div>\r\n      <div className={'cPMain_rightSpace'} />\r\n    </section>\r\n  )\r\n}\r\n\r\nCPMain.propTypes = {\r\n\r\n}\r\n\r\nexport default CPMain\r\n","import { Button } from 'antd'\r\nimport React from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { useHistory, useLocation } from 'react-router-dom'\r\n\r\nimport './Navigation.scss'\r\n\r\nexport const Navigation = (props) => {\r\n\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n  const buttons = [\r\n    {text: 'Market', linkTo: 'market', disabled: true},\r\n    {text: 'Messenger', linkTo: 'messenger', disabled: false},\r\n    {text: ' ', linkTo: '', disabled: true},\r\n    {text: 'Me', linkTo: 'me', disabled: false},\r\n  ]\r\n\r\n  return (\r\n    <section className='navigation'>\r\n      <div className='navigation__wrapper'>\r\n        {buttons.map(({text, linkTo, disabled}) => {\r\n          return <div className='navigation__wrapper_button'>\r\n          <Button onClick={() => history.push(linkTo)}\r\n            disabled={disabled}>\r\n            {text}\r\n          </Button>\r\n        </div>\r\n        })}\r\n      </div>\r\n    </section>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  \r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  \r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Navigation)\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { Link } from 'react-router-dom'\r\nimport { connect } from 'react-redux'\r\n\r\nimport { CPHeader, CPMain } from './layout'\r\n\r\nimport { microEvent } from '@/actions';\r\n\r\nimport './ChoosePage.scss'\r\n\r\nconst ChoosePage = ({microEvent, ...another}) => {\r\n\r\n  console.log('ANO_DEBUG: ', another);\r\n\r\n  return (\r\n    <section className={'choosePage'}>\r\n      {/* <div className={'choosePage_header'}>\r\n        \r\n      </div> */}\r\n      <CPHeader />\r\n      <CPMain />\r\n      {/* <div className={'choosePage_main'}>\r\n        \r\n      </div> */}\r\n    </section>\r\n  )\r\n}\r\n\r\nChoosePage.propTypes = {\r\n\r\n}\r\n\r\nexport default connect(state => ({...state}), { microEvent })(ChoosePage)\r\n","import React from 'react'\r\nimport { useHistory } from 'react-router-dom'\r\n\r\nimport { Button } from 'antd'\r\n\r\nimport './PreviewPage.scss';\r\n\r\nconst PreviewPage = props => {\r\n\r\n  const history = useHistory()\r\n\r\n  function goTo(pass) {\r\n    history.push(pass)\r\n  }\r\n\r\n  return (\r\n    <section className='previewPage' >\r\n      <div className='previewPage_title'>\r\n        {`Denilay's chat`}\r\n      </div>\r\n      <div className='previewPage_main'>\r\n        <Button onClick={() => goTo('messenger')}>\r\n          {'Messanger'}\r\n        </Button>\r\n        <Button onClick={() => goTo('me')}>\r\n          {'Me'}\r\n        </Button>\r\n      </div>\r\n    </section>\r\n  )\r\n}\r\n\r\nPreviewPage.propTypes = {\r\n\r\n}\r\n\r\nexport default PreviewPage\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport { connect } from 'react-redux'\r\n\r\nconst ResultPage = ({elements}) => {\r\n  \r\n  debugger\r\n  const data = [];\r\n\r\n  let i = -1;\r\n  const propsArr = Object.keys(elements)\r\n  while(++i < propsArr.length){\r\n    data.push(\r\n      <div>\r\n        {`${propsArr[i]}`}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {\"Result\"}\r\n      <Link to={'/main'} >{\"Main\"}</Link>\r\n      {data}\r\n      \r\n    </div>\r\n  )\r\n}\r\n\r\nResultPage.propTypes = {\r\n\r\n}\r\n\r\nexport default connect((\r\n  {products: {microEls}}\r\n  ) => (\r\n    {elements: microEls.elements\r\n    }))(ResultPage); \r\n","import React, { useState } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { Redirect } from 'react-router-dom'\r\n\r\nimport { privateMsg, joinToRoom, getMsgs } from '@/actions'\r\n\r\nimport './TestPage.scss';\r\n\r\nexport const TestPage = (\r\n  { isAuth,\r\n\r\n    privateMsg, \r\n    joinToRoom, \r\n    getMsgs \r\n  }) => {\r\n\r\n  const [msg, setMsg] = useState('Hey, Zues');\r\n  const [addres, setAddres] = useState('Olimpia');\r\n\r\n  function sendHandler() {\r\n    privateMsg({msg, addres})\r\n  }\r\n\r\n  const [room, setRoom] = useState('Olimpia');\r\n\r\n  function joinHandler() {\r\n    joinToRoom({room})\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <section className='testPage'>\r\n        <div className='testPage_msg'>\r\n          <input value={msg} onChange={(ev) => setMsg(ev.target.value)} placeholder={'Msg'}/>\r\n          <input value={addres} onChange={(ev) => setAddres(ev.target.value)} placeholder={'Addres'} />\r\n          <button onClick={sendHandler}>SEND</button>\r\n        </div>\r\n        <div className='testPage_msg'>\r\n          <input value={room} onChange={(ev) => setRoom(ev.target.value)} placeholder={'Room'} />\r\n          <button onClick={joinHandler}>JOIN</button>\r\n        </div>\r\n        <div>\r\n          <button onClick={() => {console.clear(); getMsgs()}}>GET_MSGS</button>\r\n        </div>\r\n      </section>\r\n      {!isAuth && <Redirect to={'/login'} />}\r\n    </>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = ({dialogs:{isAuth}}) => ({\r\n  isAuth\r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  privateMsg, joinToRoom, getMsgs\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TestPage)\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { Link, Redirect } from 'react-router-dom'\r\nimport { connect } from 'react-redux'\r\n\r\nimport { Login } from '@@/containers'\r\n\r\nimport './LoginPage.scss'\r\n\r\nfunction LoginPage({isAuth}) {\r\n  return (\r\n    <section className='loginPage'>\r\n      {/* {isAuth && <Redirect to={'/test'} />} */}\r\n      {/* <Link to='/test'>{\"/Test\"}</Link> */}\r\n      <Login />\r\n    </section>\r\n  )\r\n}\r\n\r\nLoginPage.propTypes = {\r\n\r\n}\r\n\r\nexport default connect(({dialogs: {isAuth}}) => ({isAuth}))(LoginPage)\r\n\r\n","import React, { useEffect } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport classNames from 'classnames'\r\nimport { useHistory } from 'react-router-dom'\r\n\r\nimport { pickDialog, createNewDialog, unsetDialogId } from '@/actions'\r\n\r\nimport { Dialog, SearchPeople } from '@@/containers'\r\n\r\nimport './DialogsTab.scss'\r\n\r\nexport const DialogsTab = (\r\n  {\r\n    dialogs,\r\n    user,\r\n    dialogTabMod, \r\n    choosenDialogId,\r\n    v,\r\n    showSearchPeople,\r\n\r\n    pickDialog,\r\n    createNewDialog,\r\n    unsetDialogId\r\n  }) => {\r\n  const history = useHistory();\r\n\r\n  //====================MOBILE_ONLI====================\r\n  useEffect(() => {\r\n    if(choosenDialogId !== null) {\r\n      unsetDialogId()\r\n    }\r\n  })\r\n  //====================MOBILE_ONLI====================\r\n\r\n  const clickHandler = _id => {\r\n    history.push('chat')\r\n    pickDialog(_id)\r\n  }\r\n\r\n  const dialogsComponents = dialogs.map(dialogData => \r\n    <Dialog {...dialogData} \r\n    me={user} \r\n    onClick={clickHandler} \r\n    choosenId={choosenDialogId} \r\n    />)\r\n\r\n  const showDialogs = dialogsComponents.length;\r\n  \r\n  const searchPeopleClickHandler = (id) => {\r\n    history.push('chat')\r\n    // Этот код нужно вынести на сервер, если я буду пуллить диалоги\r\n    let dialogId = '';\r\n    if(dialogs.some(({dialog: {author, partner, _id}}) => {\r\n      if(author['_id'] === id || partner['_id'] === id) {\r\n        dialogId = _id;\r\n        return true\r\n      }\r\n    })) {\r\n      pickDialog(dialogId)\r\n    } else {\r\n      createNewDialog(id)\r\n    }\r\n    \r\n  }\r\n  const choosenUserId = (() => {\r\n    let res = null\r\n    let i = -1;\r\n    while(++i < dialogs.length) {\r\n      const { dialog: {author, partner, _id} } = dialogs[i];\r\n      if(_id === choosenDialogId) {\r\n        if(author['_id'] === user['_id']) {\r\n          res = partner['_id']\r\n        } else {\r\n          res = author['_id']\r\n        }\r\n      }\r\n    }\r\n\r\n    return res;\r\n  })()\r\n\r\n  const searchPeoples = showSearchPeople.map(searchUser => {\r\n    return searchUser['_id'] !== user['_id']\r\n    ? \r\n    <SearchPeople user={searchUser} \r\n    onClick={searchPeopleClickHandler} \r\n    choosenUserId={choosenUserId} \r\n    />\r\n    : null\r\n  })\r\n\r\n  console.log('DIALOGS_COMPONENT:', dialogsComponents)\r\n\r\n  return (\r\n    <section className='dialogsTab'>\r\n      {\r\n        dialogTabMod === 'search'\r\n        ?\r\n        <div className='dialogsTab__wrapper'>\r\n          {searchPeoples}\r\n        </div>\r\n        :\r\n        <div className={classNames(\r\n          'dialogsTab__wrapper', \r\n          showDialogs ? null : 'dialogsTab__wrapper-help',\r\n        )}>\r\n          {showDialogs\r\n            ? dialogsComponents\r\n            : \"Find some-body\"\r\n          } \r\n        </div>\r\n      }\r\n      \r\n    </section>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (\r\n  {dialogs: {\r\n    dialogs, \r\n    user, \r\n    dialogTabMod, \r\n    choosenDialogId,\r\n    v,\r\n    showSearchPeople,\r\n  }\r\n  }) => ({\r\n  dialogs, \r\n  user, \r\n  dialogTabMod, \r\n  choosenDialogId,\r\n  v,\r\n  showSearchPeople,\r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  pickDialog, \r\n  createNewDialog,\r\n  unsetDialogId\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DialogsTab)\r\n","import React, { useState } from 'react'\r\nimport { connect } from 'react-redux'\r\n\r\nimport { Input } from 'antd'\r\nimport { CloseOutlined, SearchOutlined } from '@ant-design/icons';\r\n\r\nimport { setDialogTabMod, addQuery } from '@/actions'\r\n\r\nimport './DialogsSearch.scss'\r\n\r\nexport const DialogsSearch = (\r\n  {\r\n    dialogTabMod,\r\n\r\n    setDialogTabMod,\r\n    addQuery\r\n  }) => {\r\n\r\n  const [searchValue, setSearchValue] = useState('')\r\n  const isSearch = dialogTabMod === 'search'\r\n\r\n  function focusHandler (ev) {\r\n    if(!isSearch) {\r\n      setDialogTabMod('search')\r\n    }\r\n  }\r\n\r\n  function changeHandler (ev) {\r\n    setSearchValue(ev.target.value)\r\n    addQuery(ev.target.value)\r\n  }\r\n\r\n  function closeClickHandler(ev) {\r\n    setDialogTabMod('base')\r\n    setSearchValue('')\r\n  }\r\n\r\n  \r\n\r\n  return (\r\n    <section className={'dialogsSearch'}>\r\n      <Input\r\n       placeholder={'Search persons'} \r\n       bordered={false}  \r\n       onFocus={focusHandler}\r\n       onChange={changeHandler}\r\n       value={searchValue}\r\n       onPressEnter={ev => console.log('PRESS_ENTER')}\r\n\r\n       />\r\n\r\n      <div className={'dialogsSearch__stopSearch'}>\r\n        {\r\n          isSearch \r\n          ? <div \r\n              className={'dialogsSearch__stopSearch_icon'} \r\n              onClick={closeClickHandler}>\r\n              <CloseOutlined />\r\n            </div>\r\n          : <div \r\n              className={'dialogsSearch__stopSearch_icon'} \r\n              onClick={focusHandler}>\r\n              <SearchOutlined />\r\n            </div>\r\n        }\r\n      </div>\r\n    </section>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = ({dialogs: {dialogTabMod}}) => ({\r\n  dialogTabMod\r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  setDialogTabMod,\r\n  addQuery\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DialogsSearch)\r\n","import React from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { Redirect, useLocation } from 'react-router-dom'\r\n\r\nimport { DialogsTab, DialogsSearch } from './layout'\r\nimport { MenuButton } from '@@/components'\r\n\r\nimport './MessangerPage.scss'\r\n\r\nexport const MessangerPage = ({isAuth}) => {\r\n  const location = useLocation()\r\n\r\n  return (\r\n    <>\r\n      <section className='messangerPage'>\r\n        <div className='messangerPage_header'>\r\n          <div className='messangerPage_header__return'>\r\n            <MenuButton />\r\n          </div>\r\n          <div className='messangerPage_header__search'>\r\n            <DialogsSearch />\r\n          </div>\r\n        </div>\r\n        <div className='messangerPage_dialogs'>\r\n          <DialogsTab />\r\n        </div>\r\n      </section>\r\n      {!isAuth && <Redirect to={{pathname: \"/login\", state: { from: location.pathname}}} />}\r\n    </>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = ({dialogs: {isAuth}}) => ({\r\n  isAuth\r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  \r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MessangerPage)\r\n","import React, { useState, useEffect } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { useHistory } from 'react-router-dom'\r\n\r\nimport { Button, Input, message } from 'antd'\r\n\r\nimport { editProfile, logOut } from '@/actions'\r\nimport { openNotification } from '@/utils'\r\n\r\nimport './Editor.scss'\r\n\r\nexport const Editor = (\r\n  {\r\n    user,\r\n\r\n    onEdit,\r\n    setOnEdit,\r\n    reset,\r\n    setReset,\r\n\r\n    editProfile,\r\n    logOut,\r\n  }) => {\r\n  const history = useHistory();\r\n  const [inputValue, setInputValue] = useState({\r\n    nickName: user?.nickName || '',\r\n    loginName: user?.loginName || '',\r\n    password: user?.password || '',\r\n  });\r\n\r\n  let unsavedParams = [];\r\n    if(user !== null) {\r\n      const { nickName='', loginName='', password=''} = user;\r\n      const { nickName: nN, loginName: lN, password: pw } = inputValue;\r\n      if(nickName!==nN) {\r\n        unsavedParams.push('nickName')\r\n      }\r\n      if(loginName!==lN) {\r\n        unsavedParams.push('loginName')\r\n      }\r\n      if(password !==pw) {\r\n        unsavedParams.push('password')\r\n      }\r\n    }\r\n\r\n  if(unsavedParams.length && !onEdit) {\r\n    setOnEdit(true)\r\n  } else if(!unsavedParams.length && onEdit) {\r\n    setOnEdit(false)\r\n  }\r\n  \r\n\r\n  const { nickName, loginName, password } = inputValue\r\n  \r\n  function resetHandler() {\r\n    const { nickName, loginName, password } = user;\r\n    setInputValue({nickName, loginName, password});\r\n    setReset(false);\r\n  }\r\n\r\n  function saveHandler() {\r\n    // Необходима минимальная валидация\r\n    if(!unsavedParams.length) {\r\n      return\r\n    }\r\n \r\n    if (Object.values(inputValue).every((el) => el.length >= 3)) {\r\n      editProfile(inputValue)\r\n    } else {\r\n      openNotification({\r\n        type: 'warning', \r\n        title: 'Warning', \r\n        description: 'The minimum response length for each field is 3 characters'\r\n      })\r\n    }\r\n  }\r\n\r\n  function logOutHandler() {\r\n    delete localStorage.token\r\n    delete window.axios.defaults.headers.common['token']\r\n    logOut();\r\n    history.push('login')\r\n  }\r\n\r\n  useEffect(() => {\r\n    if(reset) {\r\n      resetHandler()\r\n    }\r\n  })\r\n\r\n\r\n  return (\r\n    <section className='editor'>\r\n      <div className='editor__main'>\r\n        <div className='editor__main_inputs'>\r\n\r\n          <div className='editor__main_inputs_wrapper'>\r\n            <div className=\"addone\">{\"NickName\"}</div>\r\n            <Input \r\n              onChange={({target: {value}}) => setInputValue({...inputValue, nickName: value})}\r\n              // addonBefore={}  \r\n              value={nickName} />\r\n          </div>\r\n\r\n          <div className='editor__main_inputs_wrapper'>\r\n            <div className=\"addone\">{\"LoginName\"}</div>\r\n            <Input \r\n              onChange={({target: {value}}) => setInputValue({...inputValue, loginName: value})}\r\n              value={loginName} />\r\n          </div>\r\n\r\n          <div className='editor__main_inputs_wrapper'>\r\n            <div className=\"addone\">{\"Password\"}</div>\r\n            <Input \r\n              onChange={({target: {value}}) => setInputValue({...inputValue, password: value})}\r\n              // addonBefore={}\r\n              placeholder={'New password'}\r\n              value={password} />\r\n          </div>\r\n\r\n         \r\n        </div>\r\n        <div className='editor__main_buttons'>\r\n          <Button onClick={saveHandler}>\r\n            Save\r\n          </Button>\r\n          <Button danger onClick={logOutHandler}>\r\n            LogOut\r\n          </Button>\r\n        </div>\r\n      </div>\r\n      {/* <div className='editor__state'>\r\n        {\r\n          unsavedParams.length \r\n          ?\r\n          <>\r\n            <div className='editor__state_reset'>\r\n              <Button type=\"dashed\" onClick={resetHandler}>\r\n                {'Reset changes'}\r\n              </Button>\r\n            </div>\r\n            <div className='editor__state_unsaved'>\r\n              {'*Unsaved:'}\r\n              <ul>\r\n                {unsavedParams.map(el => <li>{el}</li>)}\r\n              </ul>\r\n            </div>\r\n            \r\n          </>\r\n          : null\r\n        }\r\n      </div> */}\r\n    </section>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = ({dialogs: {user}}) => ({\r\n  user\r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  editProfile,\r\n  logOut\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Editor)\r\n","import React from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { useHistory } from 'react-router-dom'\r\n\r\nimport { Button } from 'antd';\r\nimport { LeftOutlined } from '@ant-design/icons';\r\n\r\nimport './MeHeader.scss'\r\n\r\nexport const MeHeader = ({onEdit, setReset}) => {\r\n  const history = useHistory();\r\n\r\n  return (\r\n    <section className='meHeader'>\r\n      <div className='meHeader__leftPart' onClick={() => history.push('/')}>\r\n        <LeftOutlined />\r\n      </div>\r\n      <div className='meHeader__rightPart'>\r\n        <div className='meHeader__rightPart_label'>\r\n          {`Profile${onEdit ? '*' : ''}`}\r\n        </div>\r\n        {\r\n          onEdit &&\r\n          <div className='meHeader__rightPart_reset'>\r\n            <Button type=\"dashed\" onClick={() => setReset(true)}>\r\n              {'Reset changes'}\r\n            </Button>\r\n          </div>\r\n        }\r\n      </div>\r\n    </section>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  \r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  \r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MeHeader)\r\n","import React, { useState, useEffect, useRef } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { Redirect, useLocation } from 'react-router-dom'\r\n\r\nimport { Editor, MeHeader } from './layout'\r\n\r\nimport './MePage.scss'\r\n\r\nexport const MePage = (\r\n  {\r\n    isAuth\r\n  }) => {\r\n  const location = useLocation()\r\n  const [onEdit, setOnEdit] = useState(false)\r\n  const [reset, setReset] = useState(false); // служебная вызывалка\r\n  // Нужно начинать описывать через архитект. докум.\r\n\r\n  const [height, setHeight] = useState({payload: 0, seted: false});\r\n  const wrapper = useRef();\r\n\r\n  useEffect(() => {\r\n    if(!height.seted) {\r\n      setHeight({payload: wrapper.current.clientHeight, seted: true})\r\n    }\r\n\r\n    window.onresize = function () {\r\n      setHeight({payload: 0, seted: false})\r\n    }\r\n  })\r\n\r\n  return (\r\n    <>\r\n      <section className='mePage'>\r\n        <div className='mePage__header'>\r\n          <MeHeader onEdit={onEdit} setReset={(pass) => setReset(pass)} />\r\n        </div>\r\n        <div className='mePage__wrapper' ref={wrapper}>\r\n          <div className='mePage__wrapper_editor' \r\n            style={{height: height.payload}}>\r\n            <Editor \r\n              reset={reset} \r\n              setReset={pass => setReset(pass)} \r\n              setOnEdit={(pass) => setOnEdit(pass)} \r\n              onEdit={onEdit} /> \r\n          </div>\r\n        </div>\r\n      </section>\r\n      {!isAuth && <Redirect to={{pathname: \"/login\", state: { from: location.pathname}}} />}\r\n    </>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = ({dialogs}) => ({\r\n  isAuth: dialogs.isAuth\r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  \r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MePage)\r\n","import React, { useEffect, useState } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { useHistory } from 'react-router-dom'\r\n\r\nimport { LeftOutlined } from '@ant-design/icons';\r\n\r\nimport './ChatHeader.scss'\r\n\r\nexport const ChatHeader = ({dialogs, choosenDialogId, user, v}) => {\r\n  const history = useHistory();\r\n\r\n  const [personData, setPersonData] = useState({nickName: '', lastSeen: '', lastV: ''})\r\n  useEffect(() => {\r\n    // Обработка каких либо изменений и обновление данных в шапке\r\n\r\n    const keyWord = v.split('$$')[0];\r\n    if(v !== personData.lastV) {\r\n      switch(keyWord) {\r\n        case 'pickDialog':\r\n        case 'setProfile':\r\n        case 'setOnline': \r\n        case 'pickEvent':\r\n        (() => {\r\n          let i = -1;\r\n          while(++i < dialogs.length) {\r\n            \r\n            if(dialogs[i].dialog['_id'] === choosenDialogId) {\r\n              const { author, partner } = dialogs[i].dialog\r\n              const partnerData = author['_id'] === user['_id'] ? partner : author;\r\n              const { nickName, online } = partnerData;\r\n\r\n              setPersonData({\r\n                nickName, \r\n                lastSeen: online ? 'online' : 'offline', \r\n                lastV: v\r\n              })\r\n            }\r\n          }\r\n\r\n          \r\n        })()\r\n        break\r\n        default:\r\n        break\r\n      }\r\n    }\r\n    \r\n  })\r\n\r\n  const { nickName, lastSeen } = personData\r\n  return (\r\n    <section className={'chatHeader'}>\r\n      <div className='chatHeader__leftPart' onClick={() => history.push('/messenger')}>\r\n        <LeftOutlined />\r\n      </div>\r\n      <div className='chatHeader__rightPart'>\r\n        <div className='chatHeader__rightPart_partnerName'>\r\n          {nickName}\r\n        </div>\r\n        <div className='chatHeader__rightPart_lastSeenDate'>\r\n          {lastSeen}\r\n        </div>\r\n      </div>\r\n    </section>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = ({dialogs: {dialogs, choosenDialogId, user, v}}) => ({\r\n  dialogs, choosenDialogId, user, v\r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  \r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChatHeader)\r\n","import React, { useState, useRef, useEffect } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport classNames from 'classnames'\r\n\r\n\r\nimport { Message, DateElement } from '@@/components'\r\n\r\nimport { readMessages, getPollMessages } from '@/actions'\r\n\r\nimport './Chat.scss'\r\n\r\n\r\n\r\nexport const Chat = (\r\n  {\r\n  choosenDialogId,\r\n  readyMessengesData,\r\n  dialogs, \r\n  newDialogTargetId,\r\n  v,\r\n  isLiveUnreaded,\r\n\r\n  readMessages,\r\n  getPollMessages\r\n}) => {\r\n  \r\n\r\n  const [overflowData, setOverflowData] = useState({})\r\n\r\n  const overflow = useRef(null)\r\n\r\n  const dialogIsPicked = choosenDialogId !== null\r\n\r\n  const messages = (() => {\r\n    const res = [];\r\n    readyMessengesData\r\n    .forEach(({date, messages}) => {\r\n      res.push( <DateElement date={date} />);\r\n      messages\r\n      .forEach(data => {\r\n        res.push( <Message {...data} />)\r\n      })\r\n    });\r\n    return res;\r\n  })()\r\n\r\n  useEffect(() => {\r\n    const { scrollHeight, scrollTop, clientHeight } = overflow.current\r\n\r\n    const keyWord = v.split('$$')[0] \r\n    if(keyWord === 'pickEvent') {\r\n      // Прокручивание скролл бара вниз при загрузке странцы\r\n      overflow.current.scrollTop = scrollHeight - clientHeight;\r\n    }\r\n    if(keyWord === 'setPollMessages') {\r\n      // поиск старой высоты и фиксация на ней. Эффект удлинения страницы вверх\r\n      overflow.current.scrollTop = scrollHeight-overflowData.realHeight\r\n    }\r\n\r\n    if(keyWord === 'pickEvent' && (messages.length < 15 && messages.length >= 1)) {\r\n      // сохранение старой высоты и запрос за новыми сообщения -> новая высота\r\n      setOverflowData({realHeight: scrollHeight})\r\n      getPollMessages()\r\n    }\r\n  })\r\n\r\n  function mouseMoveHandler(ev) {\r\n    if(isLiveUnreaded) {\r\n      readMessages()\r\n    }\r\n  }\r\n\r\n  function scrollHandler() {\r\n    // обработка событие полнятия скрола на макс высоту\r\n    const { scrollTop, scrollHeight } = overflow.current;\r\n    if(scrollTop === 0 && (() => {\r\n      // Если высота сткрола действительно = 0 и есть превПулл\r\n      const prevPoll = readyMessengesData?.[0]?.messages?.[0]?.prevPoll || 'none'\r\n      return prevPoll !== 'none'\r\n    })()) {\r\n      // То сохраняется высота и делается запрос\r\n      setOverflowData({realHeight: scrollHeight})\r\n      getPollMessages()\r\n      \r\n    }\r\n  }\r\n\r\n  \r\n  \r\n  return (\r\n    <section className='chat' onMouseMove={mouseMoveHandler} >\r\n      <div className='chat__main' ref={overflow} onScroll={scrollHandler}>\r\n        <div className={classNames(\r\n          'chat__main_wrapper', \r\n          !dialogIsPicked ? 'chat__main_wrapper-help' : null\r\n          )}>\r\n          { dialogIsPicked\r\n           ? messages // [...messages, ...messages, ...messages] \r\n           : 'Pick dialog'\r\n          }\r\n        </div>\r\n      </div>\r\n    </section>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (\r\n  {dialogs: \r\n    {\r\n      choosenDialogId, \r\n      readyMessengesData, \r\n      dialogs, \r\n      newDialogTargetId,\r\n      v,\r\n      isLiveUnreaded,\r\n     \r\n    }}) => ({\r\n  choosenDialogId, \r\n  readyMessengesData,\r\n  dialogs, \r\n  newDialogTargetId,\r\n  v,\r\n  isLiveUnreaded,\r\n\r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  readMessages, getPollMessages\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Chat)\r\n","import React, { useState } from 'react'\r\nimport { connect } from 'react-redux'\r\n\r\nimport { Input, Button } from 'antd'\r\n\r\nimport { createMessage } from '@/actions'\r\n\r\nimport './ChatInput.scss'\r\n\r\nconst { TextArea } = Input\r\n\r\nexport const ChatInput = (\r\n  {\r\n    createMessage\r\n  }) => {\r\n    \r\n  const [inputValue, setInputValue] = useState('')\r\n\r\n  function submitHandler () {\r\n    createMessage(inputValue);\r\n    setInputValue('');\r\n  }\r\n\r\n  return (\r\n    <section className='chat__inputArea'>\r\n      <div className='chat__inputArea_textArea'>    \r\n        <TextArea autoSize \r\n          onChange={ev => setInputValue(ev.target.value)}\r\n          value={inputValue} \r\n\r\n        />\r\n      </div>\r\n      <div className='chat__inputArea_button'>\r\n        <Button \r\n          onClick={submitHandler}\r\n        >Send</Button>\r\n      </div>\r\n    </section>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  \r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  createMessage\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChatInput)\r\n","import React, { useRef, useEffect, useState } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { Redirect } from 'react-router-dom'\r\n\r\nimport { ChatHeader, Chat, ChatInput } from './layout'\r\n\r\nimport './ChatPage.scss'\r\n\r\nexport const ChatPage = (\r\n  {\r\n    isAuth,\r\n\r\n  }) => {\r\n  const wrapper = useRef();\r\n  const inputRef = useRef();\r\n  const [inputHeight, setInputHeight] = useState(0)\r\n  const [height, setHeight] = useState({payload: 0, seted: false})\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    if(inputHeight === 0) {\r\n      console.log(inputRef.current.clientHeight)\r\n      setInputHeight(inputRef.current.clientHeight)\r\n    }\r\n    if(!height.seted && inputHeight !== 0) {\r\n      \r\n      setHeight({payload: wrapper.current.clientHeight, seted: true})\r\n    }\r\n    \r\n    // возможна проблема с перезапись в объект window\r\n    window.onresize = function () {\r\n      \r\n      // После ресайза необходимо занулить сообщения\r\n      // Что бы точно знать высоту, которая имеется в распоряжении\r\n      setHeight({payload: inputHeight, seted: false})\r\n\r\n      // небольшая добавочка) можно сделать инпут в относительных единицах\r\n      // тогда нулевой итерации можно было бы вытащить инфу и перерисовать\r\n      // уже с высотой в пикселях\r\n    }\r\n  })\r\n\r\n  return (\r\n    <>\r\n      <section className='chatPage'>\r\n        <div className='chatPage_header'>\r\n          <ChatHeader />\r\n        </div>\r\n        \r\n        <div className='chatPage-wrapper' ref={wrapper}>\r\n          <div className='chatPage_messages' style={{height: height.payload - inputHeight}}>\r\n            <Chat />\r\n          </div>\r\n\r\n          <div className='chatPage_input' ref={inputRef}>\r\n            <ChatInput />\r\n          </div>\r\n        </div>\r\n        {!isAuth && <Redirect to={{pathname: \"/login\", state: { from: '/messenger'}}} />}\r\n      </section>\r\n    </>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = ({dialogs: {isAuth}}) => ({\r\n  isAuth\r\n})\r\n\r\nconst mapDispatchToProps = {\r\n  \r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChatPage)\r\n","import React from 'react';\r\nimport { \r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route,\r\n  Link,\r\n  Redirect,\r\n  } from 'react-router-dom'\r\n\r\nimport { \r\n  PreviewPage, \r\n  ResultPage, \r\n  ChoosePage, \r\n  TestPage, \r\n  LoginPage, \r\n  MessengerPage,\r\n  MePage,\r\n  ChatPage,\r\n\r\n} from '@@/pages'\r\n\r\nimport './styles/index.scss';\r\n\r\nconst App = () => {\r\n\r\n  return (\r\n    <div className='pageWrapper'>\r\n      <Router>\r\n        <Switch>\r\n          <Route exact path=\"/\">\r\n            <PreviewPage />\r\n          </Route>\r\n          <Route exact path=\"/result\">\r\n            <ResultPage />\r\n          </Route>\r\n          <Route path=\"/main\">\r\n            <ChoosePage />\r\n          </Route>\r\n          <Route exact path=\"/dude/*\">\r\n            <div>{\"hey dude\"}</div>\r\n          </Route>\r\n          <Route exact path=\"/test\">\r\n            <TestPage />\r\n          </Route>\r\n          <Route exact path='/login'>\r\n            <LoginPage />\r\n          </Route>\r\n          <Route exact path='/messenger'>\r\n            <MessengerPage />\r\n          </Route>\r\n          <Route exact path='/me'>\r\n            <MePage />\r\n          </Route>\r\n          <Route exact path='/chat'>\r\n            <ChatPage />\r\n          </Route>\r\n        </Switch>\r\n      </Router>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default App;","import React from 'react'\r\nimport { render } from 'react-dom'\r\n\r\nimport { Provider } from 'react-redux'\r\n\r\nimport store from './store';\r\n\r\nimport App from './view/App'\r\n\r\n\r\n\r\n\r\nrender(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById('root')\r\n)\r\n"],"sourceRoot":""}